BVSF Model â€” Evolutionary Dynamics of Fungal Symbioses
Bottleneckâ€“Variationâ€“Selectionâ€“Feedback (BVSF) Simulation Framework

This repository contains the full simulation code for the BVSF model, developed to study the evolutionary dynamics of fungal symbioses in ambrosia beetles.
The framework integrates:

Ecological competition (generalized Lotkaâ€“Volterra dynamics)

Genetic drift under transmission bottlenecks

Selection during gallery growth

Fixation and coexistence probabilities

Multi-species community dynamics & ESS analysis

Full reliability tests for numerical stability and reproducibility

All figures generated by the model are publication-ready and formatted in a Nature-style layout.

ğŸ”§ Repository Structure
bvsf-model/
â”‚
â”œâ”€â”€ BVSF_v5.py                 # Main simulation framework (Figures 1â€“9)
â”œâ”€â”€ reliability_tests_v5.py    # Reproducibility and numerical reliability tests
â”‚
â”œâ”€â”€ figure/                    # Auto-generated figures (created at runtime)
â””â”€â”€ figures/                   # Reliability test outputs

ğŸ“Š Features Included in BVSF_v5.py
Figure 1 â€” LV Competitive Dynamics

Phase-plane flow field

Nullclines and equilibria

Eigenvalue-based stability

Parameter space mapping of coexistence regions

Figure 2 â€” Coexistence Time vs Carrying Capacity

Survival simulations

Power-law fitting with CI

Violin plots of coexistence distributions

Figure 3 â€” Neutral Drift & Fixation

Wrightâ€“Fisher drift simulations

Variance scaling with N

Comparison with theoretical prediction

Figure 4 â€” Driftâ€“Selection Threshold

Replacement probability heatmap

Kimura fixation theory overlay

Cross-sections for specific N

Figure 5 â€” Coalescence Time

Drift trajectories

Linear scaling (slope â‰ˆ 2N)

Regression diagnostics

Figure 6 â€” Multi-species Dynamics

Five-species LV + bottleneck system

Shannon diversity collapse

Winner distribution statistics

Figure 7 â€” Driftâ€“Selection Balance

Ns regime visualization

Mean trajectories under different s, N

Figure 8 â€” Fixation Time Distribution

Boxplots

CV scaling

Exponential decay fit

Figure 9 â€” ESS Analysis

Deterministic replicator dynamics

Stochastic replicator + drift

Correlation between fitness and success rate

ğŸ§ª Reliability Tests (reliability_tests_v5.py)

Includes numerical validation for:

LV system stability across step sizes

Neutral drift convergence

Replacement threshold reproducibility

Coalescence time scaling (â‰ˆ 2N)

Coexistence time stability

Multi-species winner distribution consistency

All tests save results to ./figures/.

Run all tests:

python reliability_tests_v5.py

â–¶ï¸ How to Run Simulations

Generate all figures (1â€“9):

python BVSF_v5.py


This will create a figure/ folder containing high-resolution PNGs.

ğŸ“¦ Dependencies

Install required packages:

pip install numpy scipy matplotlib scikit-learn

ğŸ“š Citation

If you use this model in academic work, please cite:

Jiang, Z.-R. (2025). BVSF evolutionary simulation framework for fungal symbiosis.
GitHub: https://github.com/sugkp112/bvsf-model


(Add Zenodo DOI here after you generate it.)

ğŸ“¬ Contact

For questions, discussion, or collaboration:

Email: ziru.jiang@gmail.com
